<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>IDS/IPS Dashboard</title>
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <h1>IDS/IPS Dashboard</h1>
    <div class="dashboard-grid">
        <div>
            <h2>Grafik Serangan per Jam/Hari</h2>
            <canvas id="attackLineChart"></canvas>
        </div>
        <div>
            <h2>Jenis Serangan (Pie Chart)</h2>
            <canvas id="attackPieChart"></canvas>
        </div>
        <div>
            <h2>Top 5 Offending IPs</h2>
            <ul id="topIps">
                <li>192.168.1.10 (12x)</li>
                <li>192.168.1.11 (8x)</li>
                <li>192.168.1.12 (5x)</li>
                <li>10.0.0.1 (3x)</li>
                <li>8.8.8.8 (2x)</li>
            </ul>
        </div>
        <div>
            <h2>Status Real-time</h2>
            <div id="status">Sniffer: <span style="color:green">Aktif</span></div>
            <h3>Live Feed</h3>
            <ul id="liveFeed"></ul>
        </div>
        <div>
            <h2>Kontrol Panel</h2>
            <form id="unblockForm">
                <input type="text" id="ipToUnblock" placeholder="IP yang ingin di-unblock">
                <button type="submit">Unblock IP</button>
            </form>
            <h3>Edit config.json</h3>
                <div class="dashboard-grid">
                    <div class="card">
                        <h3>Statistik Serangan</h3>
                        <canvas id="attackStatChart" height="120"></canvas>
                    </div>
                    <div class="card">
                        <h3>Jenis Serangan</h3>
                        <canvas id="attackTypeChart" height="120"></canvas>
                    </div>
                    <div class="card">
                        <h3>Top 5 IP Penyerang</h3>
                        <ul id="topIpList"></ul>
                    </div>
                    <div class="card">
                        <h3>Status</h3>
                        <ul>
                            <li>Sniffer: <span id="statusSniffer">-</span></li>
                            <li>IPS: <span id="statusIPS">-</span></li>
                        </ul>
                    </div>
                </div>
                <div class="dashboard-grid" style="margin-top:2em">
                    <div class="card">
                        <h3>Live Feed (WebSocket)</h3>
                        <pre id="liveFeed" style="height:180px;overflow:auto;background:#222;color:#fff;padding:1em;font-size:0.95em"></pre>
                    </div>
                    <div class="card">
                        <h3>Kontrol Panel</h3>
                        <form id="unblockForm">
                            <label>Unblock IP:</label>
                            <input type="text" id="unblockIp" placeholder="IP address" required style="width:60%">
                            <button type="submit">Unblock</button>
                        </form>
                        <button id="editConfigBtn" style="margin-top:1em">Edit config.json</button>
                    </div>
                </div>
                <div id="configModal" class="modal">
                    <div class="modal-content">
                        <span id="closeConfigModal" class="close">&times;</span>
                        <h3>Edit config.json</h3>
                        <textarea id="configTextarea" style="width:100%;height:200px"></textarea>
                        <button id="saveConfigBtn">Simpan</button>
                    </div>
                </div>
